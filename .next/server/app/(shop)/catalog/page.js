(()=>{var e={};e.id=922,e.ids=[922],e.modules={85890:e=>{"use strict";e.exports=require("better-sqlite3")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},79348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},11001:e=>{e.exports={style:{fontFamily:"'Montserrat', 'Montserrat Fallback'",fontStyle:"normal"},className:"__className_0385ae"}},21660:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=r(49442),a=r(10042),n=r(48190),i=r.n(n),l=r(63289),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d=["",{children:["(shop)",{children:["catalog",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,97428)),"/Users/jojo/Documents/Projects/money-tree-next/src/app/(shop)/catalog/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,63013)),"/Users/jojo/Documents/Projects/money-tree-next/src/app/(shop)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,6042,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,6042,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/jojo/Documents/Projects/money-tree-next/src/app/(shop)/catalog/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(shop)/catalog/page",pathname:"/catalog",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},62927:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,60903,23)),Promise.resolve().then(r.t.bind(r,90821,23))},48628:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,62704,23)),Promise.resolve().then(r.t.bind(r,73510,23))},12154:(e,t,r)=>{"use strict";r.d(t,{q:()=>a});var s=r(93726);let a=async()=>(function(e){let t={};e.forEach(e=>{t[e.id]={...e,children:[]}});let r=[];return e.forEach(e=>{null===e.parentId?r.push(t[e.id]):t[e.parentId].children.push(t[e.id])}),r})(await s.Z.query.$Categories.findMany())},97428:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m,metadata:()=>p});var s=r(47705),a=r(93726),n=r(38176);r(66833);var i=r(7099);function l({items:e}){return(0,s.jsx)("ul",{className:"pr-4",children:e.map(e=>(0,s.jsx)(i.Z,{category:e,isRoot:!0},e.id))})}var o=r(12154);async function d(){let e=await (0,o.q)();return(0,s.jsx)("aside",{className:"py-4",children:(0,s.jsx)(l,{items:e})})}var c=r(84160),u=r(99069);let p={title:"Каталог",description:""};async function m({searchParams:e}){let t=(await e).category||"[]";Array.isArray(t)&&(t="[]");let r=JSON.parse(t),i=(r.length>0?await a.Z.query.$Products.findMany({where:(0,u.xD)((0,u.d3)(c.$Products.categoryId,r.map(e=>Number(e))),(0,u.eq)(c.$Products.isActive,!0))}):await a.Z.query.$Products.findMany({where:(0,u.eq)(c.$Products.isActive,!0)})).map(e=>({cost:e.price||0,discount:e.discount||0,title:e.title,image:e.previewImage,id:e.id?.toString()||""}));return(0,s.jsx)("section",{className:"container",children:(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)(d,{}),(0,s.jsx)("div",{className:"flex-1 py-6 pl-4",children:(0,s.jsx)("div",{className:"grid grid-cols-3 gap-4",children:i.map(e=>(0,s.jsx)(n.Z,{...e},e.id))})})]})})}},7099:(e,t,r)=>{"use strict";r.d(t,{W:()=>n,Z:()=>i});var s=r(47705),a=r(23496);function n(e){let t=[e.id];if(e.children&&e.children.length>0)for(let r of e.children)t.push(...n(r));return t}function i({category:e,isRoot:t}){return(0,s.jsxs)("li",{className:t?"pb-1":"pl-4 border-l border-gray-300",children:[(0,s.jsx)(a.default,{href:`/catalog?${new URLSearchParams({category:JSON.stringify(n(e))})}`,className:"link",children:e.name}),e.children&&e.children.length>0&&(0,s.jsx)("ul",{className:"ml-4",children:e.children.map(e=>(0,s.jsx)(i,{category:e,isRoot:!1},e.id))})]})}r(66833)},38176:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var s=r(47705);let a=function(){for(var e,t,r=0,s="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=function e(t){var r,s,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t){if(Array.isArray(t)){var n=t.length;for(r=0;r<n;r++)t[r]&&(s=e(t[r]))&&(a&&(a+=" "),a+=s)}else for(s in t)t[s]&&(a&&(a+=" "),a+=s)}return a}(e))&&(s&&(s+=" "),s+=t);return s};var n=r(76217),i=r(23496);r(66833);let l=function({cost:e=0,discount:t,id:r,image:l,title:o,className:d}){return(0,s.jsxs)(i.default,{className:a("relative flex flex-col overflow-hidden max-w-[266px] rounded-3xl shadow-[0px_0px_16px_0_rgba(51,37,87,0.15)]",d),href:`/product/${r}`,children:[t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"absolute top-4 right-4 bg-red-500 text-white-100  text-sm font-medium p-[6px] rounded-full",children:"Распродажа"}),(0,s.jsxs)("span",{className:"absolute top-4 left-4  bg-red-500 text-white-100 text-sm font-medium p-[6px] rounded-full",children:[Math.floor(100-(e-t)/e*100),"%"]})]}):null,(0,s.jsx)(n.default,{className:"max-w-[266px] max-h-[235px]",alt:o,width:266,height:235,src:l||"https://placehold.co/266x235/000000/FFFFFF/png"}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h3",{className:"text-base text-foreground mb-4",children:o}),t?(0,s.jsxs)("p",{className:"text-green-400 flex items-center text-xl w-fit rounded-xl py-3 px-6 bg-gray-100 ",children:[e-t,"₽ ",(0,s.jsxs)("span",{className:"line-through ml-1 text-gray-400 text-xs",children:[e,"₽"]})]}):(0,s.jsxs)("p",{className:"text-foreground flex text-xl w-fit rounded-xl py-3 px-6 bg-gray-100",children:[e,"₽"]})]})]},r)}},93726:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var s=r(33333),a=r(85890),n=r.n(a),i=r(84160);let l=new(n())(process.env.DB_FILE_NAME),o=(0,s.t)({client:l,schema:i})},84160:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$Categories:()=>d,$Products:()=>m,$Users:()=>o,CategoryRelations:()=>p,ProductRelations:()=>h,insertCategorySchema:()=>c,insertProductSchema:()=>f,selectCategorySchema:()=>u,selectProductSchema:()=>x});var s=r(5357),a=r(89155),n=r(76718),i=r(20971),l=r(40745);let o=(0,a.Px)("users",{id:(0,n.e$)().primaryKey({autoIncrement:!0}),email:(0,i.fL)().notNull().unique(),password_hash:(0,i.fL)().notNull(),salt:(0,i.fL)().notNull()}),d=(0,a.Px)("categories",{id:(0,n.e$)().primaryKey({autoIncrement:!0}),name:(0,i.fL)("name").notNull(),parentId:(0,n._L)("parent_id").references(()=>d.id,{onDelete:"cascade"})}),c=(0,l.fC)(d),u=(0,l.IO)(d),p=(0,s.lE)(d,({one:e})=>({children:e(d,{fields:[d.parentId],references:[d.id]})})),m=(0,a.Px)("products",{id:(0,n._L)("id").primaryKey({autoIncrement:!0}),sku:(0,i.fL)("sku").notNull().unique(),title:(0,i.fL)("title").notNull(),description:(0,i.fL)("description"),price:(0,n._L)("price").notNull().default(0),discount:(0,n._L)("discount").default(0),stock:(0,n._L)("stock").notNull().default(0),previewImage:(0,i.fL)("previewImage"),images:(0,i.fL)("images").notNull().$default(()=>JSON.stringify([null,null,null,null,null])),categoryId:(0,n._L)("category_id").references(()=>d.id,{onDelete:"set null"}),keywordsSearch:(0,i.fL)("keywordsSearch"),isFeatured:(0,n._L)("isFeatured",{mode:"boolean"}).default(!1),isActive:(0,n._L)("isActive",{mode:"boolean"}).default(!0),createdAt:(0,i.fL)("createdAt").default(new Date().toISOString()).notNull(),updatedAt:(0,i.fL)("updatedAt").default(new Date().toISOString()).notNull()}),f=(0,l.fC)(m),x=(0,l.IO)(m),h=(0,s.lE)(m,({one:e})=>({category:e(d,{fields:[m.categoryId],references:[d.id]})}))}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[492,146,394,704,710,711,750],()=>r(21660));module.exports=s})();