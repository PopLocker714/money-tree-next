(()=>{var e={};e.id=192,e.ids=[192],e.modules={85890:e=>{"use strict";e.exports=require("better-sqlite3")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},79348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},25348:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=r(49442),n=r(10042),o=r(48190),i=r.n(o),a=r(63289),l={};for(let e in a)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);r.d(t,l);let d=["",{children:["(shop)",{children:["product",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,37710)),"/Users/jojo/Documents/Projects/money-tree-next/src/app/(shop)/product/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,63013)),"/Users/jojo/Documents/Projects/money-tree-next/src/app/(shop)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,6042,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,6042,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/jojo/Documents/Projects/money-tree-next/src/app/(shop)/product/[id]/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/(shop)/product/[id]/page",pathname:"/product/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},43884:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,90821,23)),Promise.resolve().then(r.bind(r,306)),Promise.resolve().then(r.bind(r,93649))},96127:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,73510,23)),Promise.resolve().then(r.bind(r,54713)),Promise.resolve().then(r.bind(r,21050))},14971:(e,t,r)=>{"use strict";r.d(t,{default:()=>n.a});var s=r(39110),n=r.n(s)},39110:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return l},getImageProps:function(){return a}});let s=r(54564),n=r(97877),o=r(62704),i=s._(r(81911));function a(e){let{props:t}=(0,n.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let l=o.Image},54713:(e,t,r)=>{"use strict";r.d(t,{default:()=>a});var s=r(20149),n=r(54846),o=r(85723),i=r(63606);function a({id:e,max:t}){let{cart:r,setCart:a}=(0,n.j)(),[l,d]=(0,i.useState)(r[e]?.quantity||0),c=t=>{let s={...r};t>0?s[e]={id:e,quantity:t}:delete s[e],a(s)};return(0,s.jsx)("div",{children:l?(0,s.jsxs)("div",{className:"flex items-center my-8",children:[(0,s.jsx)("button",{className:"bg-orange-400 rounded-2xl text-center py-4 px-6 text-base border-none text-white-100 hover:bg-orange-500 disabled:bg-gray-400",disabled:0===l,onClick:()=>{let e=l-1;d(e),c(e)},children:"-"}),(0,s.jsx)("p",{className:"mx-2 text-xl",children:l}),(0,s.jsx)("button",{className:"mr-4 bg-orange-400 rounded-2xl py-4 px-6 text-base border-none text-white-100 hover:bg-orange-500 disabled:bg-gray-400",disabled:l===t,onClick:()=>{let e=l+1;d(e),c(e)},children:"+"}),(0,s.jsx)(o.default,{className:"bg-orange-400 rounded-2xl py-4 px-6 text-base border-none text-white-100 hover:bg-orange-500 disabled:bg-gray-400",href:"/cart",children:"Купить"})]}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("button",{className:"bg-orange-400 rounded-2xl py-4 px-6 text-base border-none mt-8 text-white-100 hover:bg-orange-500 disabled:bg-gray-400",onClick:()=>{d(1),c(1)},children:"Добавить в корзину"})})})}},21050:(e,t,r)=>{"use strict";r.d(t,{default:()=>d});var s=r(20149),n=r(86373),o=r(70045),i=r(14971);r(63606);var a=r(92798),l=r(10325);function d({images:e}){let t=JSON.parse(e);return(0,s.jsxs)(l.tq,{className:"swiper min-w-full h-[500px]",navigation:{enabled:!0,nextEl:".swiper-button-next__product",prevEl:".swiper-button-prev__product"},modules:[a.W_],slidesPerView:1,children:[t.map((e,t)=>e&&(0,s.jsx)(l.o5,{children:(0,s.jsx)(i.default,{width:500,height:500,src:e,alt:`Product image ${t+1}`,className:"w-full h-auto object-cover"})},t)),(0,s.jsx)("button",{className:"swiper-button-prev swiper-button-prev__product",children:(0,s.jsx)(o.Z,{})}),(0,s.jsx)("button",{className:"swiper-button-next swiper-button-next__product",children:(0,s.jsx)(n.Z,{})})]})}},86373:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(20149);let n=e=>(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:8,height:14,fill:"none",...e,children:(0,s.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M1.375 12.25 6.625 7l-5.25-5.25"})})},70045:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(20149);let n=e=>(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:8,height:14,fill:"none",...e,children:(0,s.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6.625 12.25 1.375 7l5.25-5.25"})})},12154:(e,t,r)=>{"use strict";r.d(t,{q:()=>n});var s=r(93726);let n=async()=>(function(e){let t={};e.forEach(e=>{t[e.id]={...e,children:[]}});let r=[];return e.forEach(e=>{null===e.parentId?r.push(t[e.id]):t[e.parentId].children.push(t[e.id])}),r})(await s.Z.query.$Categories.findMany())},306:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});let s=(0,r(78105).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/jojo/Documents/Projects/money-tree-next/src/app/(shop)/product/[id]/components/AddCart.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jojo/Documents/Projects/money-tree-next/src/app/(shop)/product/[id]/components/AddCart.tsx","default")},93649:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});let s=(0,r(78105).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/jojo/Documents/Projects/money-tree-next/src/app/(shop)/product/[id]/components/GalleryProduct.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jojo/Documents/Projects/money-tree-next/src/app/(shop)/product/[id]/components/GalleryProduct.tsx","default")},37710:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m,generateMetadata:()=>p});var s=r(47705),n=r(19876),o=r(93726),i=r(84160),a=r(99069),l=r(93649),d=r(306),c=r(7099),u=r(12154);async function p({params:e}){let t=(await e).id,r=await o.Z.query.$Products.findFirst({where:(0,a.eq)(i.$Products.id,+t)});return r?{title:r.title,description:r.description}:{title:"Товар не найден",description:"Товар не найден"}}async function m({params:e}){let t=(await e).id,[r,p]=await Promise.all([o.Z.query.$Products.findFirst({where:(0,a.eq)(i.$Products.id,+t),with:{category:!0}}),(0,u.q)()]);if(!r)return(0,s.jsx)("div",{className:"container",children:"Product not found"});let{discount:m,title:x,price:h,description:f,sku:g,stock:b,categoryId:j}=r,v=null!==j&&function e(t,r,s=[]){for(let n of t){if(n.id===r)return[...s,n];if(n.children&&n.children.length>0){let t=e(n.children,r,[...s,n]);if(t.length>0)return t}}return[]}(p,j),y=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(h),w=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(h-(m||0));return(0,s.jsxs)("div",{className:"container",children:[(0,s.jsxs)("div",{className:"flex my-4",children:[(0,s.jsx)(n.Z,{text:"Главная",href:".."})," ",(0,s.jsx)("span",{className:"px-2",children:"/"})," ",(0,s.jsx)(n.Z,{text:"Каталог",href:"/catalog"}),(0,s.jsx)("span",{className:"px-2",children:"/"})," ",v&&v.map(e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.Z,{text:e.name,href:`/catalog?${new URLSearchParams({category:JSON.stringify((0,c.W)(e))})}`}),(0,s.jsx)("span",{className:"px-2",children:"/"})]}))," ",x]}),(0,s.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,s.jsx)("div",{className:"flex-1 max-w-[48%]",children:(0,s.jsx)(l.default,{images:r.images})}),(0,s.jsxs)("div",{className:"flex-1 max-w-[48%] relative",children:[(0,s.jsx)("h1",{className:"text-3xl mb-4",children:r.title}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("p",{className:"text-1xl mb-6 text-gray-500",children:["Артикул: ",g," "]}),m?(0,s.jsxs)("p",{className:"text-green-400 flex items-center text-4xl font-bold w-fit",children:[w,(0,s.jsx)("span",{className:"line-through ml-1 text-gray-400 text-xl",children:y})]}):(0,s.jsx)("p",{className:"flex items-center text-4xl font-bold text-green-400 w-fit",children:y})]}),(0,s.jsx)(d.default,{id:t,max:b})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl mb-2",children:"Описание"}),f]})]})}},7099:(e,t,r)=>{"use strict";r.d(t,{W:()=>o,Z:()=>i});var s=r(47705),n=r(23496);function o(e){let t=[e.id];if(e.children&&e.children.length>0)for(let r of e.children)t.push(...o(r));return t}function i({category:e,isRoot:t}){return(0,s.jsxs)("li",{className:t?"pb-1":"pl-4 border-l border-gray-300",children:[(0,s.jsx)(n.default,{href:`/catalog?${new URLSearchParams({category:JSON.stringify(o(e))})}`,className:"link",children:e.name}),e.children&&e.children.length>0&&(0,s.jsx)("ul",{className:"ml-4",children:e.children.map(e=>(0,s.jsx)(i,{category:e,isRoot:!1},e.id))})]})}r(66833)},93726:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var s=r(33333),n=r(85890),o=r.n(n),i=r(84160);let a=new(o())(process.env.DB_FILE_NAME),l=(0,s.t)({client:a,schema:i})},84160:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$Categories:()=>d,$Products:()=>m,$Users:()=>l,CategoryRelations:()=>p,ProductRelations:()=>f,insertCategorySchema:()=>c,insertProductSchema:()=>x,selectCategorySchema:()=>u,selectProductSchema:()=>h});var s=r(5357),n=r(89155),o=r(76718),i=r(20971),a=r(40745);let l=(0,n.Px)("users",{id:(0,o.e$)().primaryKey({autoIncrement:!0}),email:(0,i.fL)().notNull().unique(),password_hash:(0,i.fL)().notNull(),salt:(0,i.fL)().notNull()}),d=(0,n.Px)("categories",{id:(0,o.e$)().primaryKey({autoIncrement:!0}),name:(0,i.fL)("name").notNull(),parentId:(0,o._L)("parent_id").references(()=>d.id,{onDelete:"cascade"})}),c=(0,a.fC)(d),u=(0,a.IO)(d),p=(0,s.lE)(d,({one:e})=>({children:e(d,{fields:[d.parentId],references:[d.id]})})),m=(0,n.Px)("products",{id:(0,o._L)("id").primaryKey({autoIncrement:!0}),sku:(0,i.fL)("sku").notNull().unique(),title:(0,i.fL)("title").notNull(),description:(0,i.fL)("description"),price:(0,o._L)("price").notNull().default(0),discount:(0,o._L)("discount").default(0),stock:(0,o._L)("stock").notNull().default(0),previewImage:(0,i.fL)("previewImage"),images:(0,i.fL)("images").notNull().$default(()=>JSON.stringify([null,null,null,null,null])),categoryId:(0,o._L)("category_id").references(()=>d.id,{onDelete:"set null"}),keywordsSearch:(0,i.fL)("keywordsSearch"),isFeatured:(0,o._L)("isFeatured",{mode:"boolean"}).default(!1),isActive:(0,o._L)("isActive",{mode:"boolean"}).default(!0),createdAt:(0,i.fL)("createdAt").default(new Date().toISOString()).notNull(),updatedAt:(0,i.fL)("updatedAt").default(new Date().toISOString()).notNull()}),x=(0,a.fC)(m),h=(0,a.IO)(m),f=(0,s.lE)(m,({one:e})=>({category:e(d,{fields:[m.categoryId],references:[d.id]})}))}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[492,146,394,704,710,711,380,750],()=>r(25348));module.exports=s})();