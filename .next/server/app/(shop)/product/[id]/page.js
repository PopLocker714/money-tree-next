(()=>{var e={};e.id=770,e.ids=[770],e.modules={87550:e=>{"use strict";e.exports=require("better-sqlite3")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},79551:e=>{"use strict";e.exports=require("url")},82447:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var n=r(70260),s=r(28203),o=r(25155),i=r.n(o),a=r(67292),l={};for(let e in a)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);r.d(t,l);let d=["",{children:["(shop)",{children:["product",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,20245)),"/home/jojo/Documents/money-tree-next/src/app/(shop)/product/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,34313)),"/home/jojo/Documents/money-tree-next/src/app/(shop)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/home/jojo/Documents/money-tree-next/src/app/(shop)/product/[id]/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new n.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/(shop)/product/[id]/page",pathname:"/product/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},17451:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,59607,23)),Promise.resolve().then(r.bind(r,34922)),Promise.resolve().then(r.bind(r,72514))},77123:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,28531,23)),Promise.resolve().then(r.bind(r,76678)),Promise.resolve().then(r.bind(r,22766))},45103:(e,t,r)=>{"use strict";r.d(t,{default:()=>s.a});var n=r(73864),s=r.n(n)},73864:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return l},getImageProps:function(){return a}});let n=r(25488),s=r(42034),o=r(41902),i=n._(r(21628));function a(e){let{props:t}=(0,s.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let l=o.Image},76678:(e,t,r)=>{"use strict";r.d(t,{default:()=>l});var n=r(45512),s=r(3342),o=r(28531),i=r.n(o),a=r(58009);function l({id:e,max:t}){let{cart:r,setCart:o}=(0,s._)(),[l,d]=(0,a.useState)(r[e]?.quantity||0),c=t=>{let n={...r};t>0?n[e]={id:e,quantity:t}:delete n[e],o(n)};return(0,n.jsx)("div",{children:l?(0,n.jsxs)("div",{className:"flex items-center my-8",children:[(0,n.jsx)("button",{className:"bg-orange-400 rounded-2xl text-center py-4 px-6 text-base border-none text-white-100 hover:bg-orange-500 disabled:bg-gray-400",disabled:0===l,onClick:()=>{let e=l-1;d(e),c(e)},children:"-"}),(0,n.jsx)("p",{className:"mx-2 text-xl",children:l}),(0,n.jsx)("button",{className:"mr-4 bg-orange-400 rounded-2xl py-4 px-6 text-base border-none text-white-100 hover:bg-orange-500 disabled:bg-gray-400",disabled:l===t,onClick:()=>{let e=l+1;d(e),c(e)},children:"+"}),(0,n.jsx)(i(),{className:"bg-orange-400 rounded-2xl py-4 px-6 text-base border-none text-white-100 hover:bg-orange-500 disabled:bg-gray-400",href:"/cart",children:"Купить"})]}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("button",{className:"bg-orange-400 rounded-2xl py-4 px-6 text-base border-none mt-8 text-white-100 hover:bg-orange-500 disabled:bg-gray-400",onClick:()=>{d(1),c(1)},children:"Добавить в корзину"})})})}},22766:(e,t,r)=>{"use strict";r.d(t,{default:()=>c});var n=r(45512),s=r(61361),o=r(9406),i=r(45103),a=r(58009),l=r(52693),d=r(14992);function c({images:e,preview:t}){let[r,c]=(0,a.useState)([]);return(0,n.jsxs)(d.RC,{className:"swiper min-w-full h-[500px]",navigation:{enabled:!0,nextEl:".swiper-button-next__product",prevEl:".swiper-button-prev__product"},modules:[l.Vx],slidesPerView:1,children:[r.map((e,t)=>e&&(0,n.jsx)(d.qr,{children:(0,n.jsx)(i.default,{width:500,height:500,src:e,alt:`Product image ${t+1}`,className:"w-full h-auto object-cover"})},"product-"+t)),(0,n.jsx)("button",{className:"swiper-button-prev swiper-button-prev__product",children:(0,n.jsx)(o.A,{})}),(0,n.jsx)("button",{className:"swiper-button-next swiper-button-next__product",children:(0,n.jsx)(s.A,{})})]})}},61361:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(45512);let s=e=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:8,height:14,fill:"none",...e,children:(0,n.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M1.375 12.25 6.625 7l-5.25-5.25"})})},9406:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(45512);let s=e=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:8,height:14,fill:"none",...e,children:(0,n.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6.625 12.25 1.375 7l5.25-5.25"})})},67084:(e,t,r)=>{"use strict";r.d(t,{b:()=>s});var n=r(29047);let s=async()=>(function(e){let t={};e.forEach(e=>{t[e.id]={...e,children:[]}});let r=[];return e.forEach(e=>{null===e.parentId?r.push(t[e.id]):t[e.parentId].children.push(t[e.id])}),r})(await n.A.query.$Categories.findMany())},34922:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});let n=(0,r(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/jojo/Documents/money-tree-next/src/app/(shop)/product/[id]/components/AddCart.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/jojo/Documents/money-tree-next/src/app/(shop)/product/[id]/components/AddCart.tsx","default")},72514:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});let n=(0,r(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/jojo/Documents/money-tree-next/src/app/(shop)/product/[id]/components/GalleryProduct.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/jojo/Documents/money-tree-next/src/app/(shop)/product/[id]/components/GalleryProduct.tsx","default")},20245:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m,generateMetadata:()=>p});var n=r(62740),s=r(76078),o=r(29047),i=r(48590),a=r(47579),l=r(72514),d=r(34922),c=r(97128),u=r(67084);async function p({params:e}){let t=(await e).id,r=await o.A.query.$Products.findFirst({where:(0,a.eq)(i.$Products.id,+t)});return r?{title:r.title,description:r.description}:{title:"Товар не найден",description:"Товар не найден"}}async function m({params:e}){let t=(await e).id,[r,p]=await Promise.all([o.A.query.$Products.findFirst({where:(0,a.eq)(i.$Products.id,+t),with:{category:!0}}),(0,u.b)()]);if(!r)return(0,n.jsx)("div",{className:"container",children:"Product not found"});let{discount:m,title:h,price:x,description:f,sku:g,stock:b,categoryId:v}=r,j=null!==v&&function e(t,r,n=[]){for(let s of t){if(s.id===r)return[...n,s];if(s.children&&s.children.length>0){let t=e(s.children,r,[...n,s]);if(t.length>0)return t}}return[]}(p,v),y=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(x),w=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(x-(m||0));return(0,n.jsxs)("div",{className:"container",children:[(0,n.jsxs)("div",{className:"flex my-4",children:[(0,n.jsx)(s.A,{text:"Главная",href:".."})," ",(0,n.jsx)("span",{className:"px-2",children:"/"})," ",(0,n.jsx)(s.A,{text:"Каталог",href:"/catalog"}),(0,n.jsx)("span",{className:"px-2",children:"/"})," ",j&&j.map(e=>(0,n.jsxs)("div",{children:[(0,n.jsx)(s.A,{text:e.name,href:`/catalog?${new URLSearchParams({category:JSON.stringify((0,c.O)(e))})}`}),(0,n.jsx)("span",{className:"px-2",children:"/"})]},e.id))," ",h]}),(0,n.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,n.jsx)("div",{className:"flex-1 max-w-[48%]",children:(0,n.jsx)(l.default,{images:r.images,preview:r.previewImage||""})}),(0,n.jsxs)("div",{className:"flex-1 max-w-[48%] relative",children:[(0,n.jsx)("h1",{className:"text-3xl mb-4",children:r.title}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("p",{className:"text-1xl mb-6 text-gray-500",children:["Артикул: ",g," "]}),m?(0,n.jsxs)("p",{className:"text-green-400 flex items-center text-4xl font-bold w-fit",children:[w,(0,n.jsx)("span",{className:"line-through ml-1 text-gray-400 text-xl",children:y})]}):(0,n.jsx)("p",{className:"flex items-center text-4xl font-bold text-green-400 w-fit",children:y})]}),(0,n.jsx)(d.default,{id:t,max:b})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl mb-2",children:"Описание"}),f]})]})}},97128:(e,t,r)=>{"use strict";r.d(t,{A:()=>a,O:()=>i});var n=r(62740),s=r(59607),o=r.n(s);function i(e){let t=[e.id];if(e.children&&e.children.length>0)for(let r of e.children)t.push(...i(r));return t}function a({category:e,isRoot:t}){return(0,n.jsxs)("li",{className:t?"pb-1":"pl-4 border-l border-gray-300",children:[(0,n.jsx)(o(),{href:`/catalog?${new URLSearchParams({category:JSON.stringify(i(e))})}`,className:"link",children:e.name}),e.children&&e.children.length>0&&(0,n.jsx)("ul",{className:"ml-4",children:e.children.map(e=>(0,n.jsx)(a,{category:e,isRoot:!1},e.id))})]})}r(76301)},29047:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(86084),s=r(87550),o=r.n(s),i=r(48590);let a=new(o())(process.env.DB_FILE_NAME),l=(0,n.f)({client:a,schema:i})},48590:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$Categories:()=>d,$Products:()=>m,$Users:()=>l,CategoryRelations:()=>p,ProductRelations:()=>f,insertCategorySchema:()=>c,insertProductSchema:()=>h,selectCategorySchema:()=>u,selectProductSchema:()=>x});var n=r(23555),s=r(21300),o=r(47095),i=r(49190),a=r(78625);let l=(0,s.D)("users",{id:(0,o.Wh)().primaryKey({autoIncrement:!0}),email:(0,i.Qq)().notNull().unique(),password_hash:(0,i.Qq)().notNull(),salt:(0,i.Qq)().notNull()}),d=(0,s.D)("categories",{id:(0,o.Wh)().primaryKey({autoIncrement:!0}),name:(0,i.Qq)("name").notNull(),parentId:(0,o.nd)("parent_id").references(()=>d.id,{onDelete:"cascade"})}),c=(0,a.r)(d),u=(0,a.aJ)(d),p=(0,n.K1)(d,({one:e})=>({children:e(d,{fields:[d.parentId],references:[d.id]})})),m=(0,s.D)("products",{id:(0,o.nd)("id").primaryKey({autoIncrement:!0}),sku:(0,i.Qq)("sku").notNull().unique(),title:(0,i.Qq)("title").notNull(),description:(0,i.Qq)("description"),price:(0,o.nd)("price").notNull().default(0),discount:(0,o.nd)("discount").default(0),stock:(0,o.nd)("stock").notNull().default(0),previewImage:(0,i.Qq)("previewImage"),images:(0,i.Qq)("images").notNull().$default(()=>JSON.stringify([null,null,null,null,null])),categoryId:(0,o.nd)("category_id").references(()=>d.id,{onDelete:"set null"}),keywordsSearch:(0,i.Qq)("keywordsSearch"),isFeatured:(0,o.nd)("isFeatured",{mode:"boolean"}).default(!1),isActive:(0,o.nd)("isActive",{mode:"boolean"}).default(!0),createdAt:(0,i.Qq)("createdAt").default(new Date().toISOString()).notNull(),updatedAt:(0,i.Qq)("updatedAt").default(new Date().toISOString()).notNull()}),h=(0,a.r)(m),x=(0,a.aJ)(m),f=(0,n.K1)(m,({one:e})=>({category:e(d,{fields:[m.categoryId],references:[d.id]})}))}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[638,641,77,340,595,837,183,314],()=>r(82447));module.exports=n})();