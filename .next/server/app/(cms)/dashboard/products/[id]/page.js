(()=>{var e={};e.id=322,e.ids=[322],e.modules={85890:e=>{"use strict";e.exports=require("better-sqlite3")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},79348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},6005:e=>{"use strict";e.exports=require("node:crypto")},93977:e=>{"use strict";e.exports=require("node:fs/promises")},49411:e=>{"use strict";e.exports=require("node:path")},5197:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>c,pages:()=>u,routeModule:()=>f,tree:()=>d});var o=r(49442),a=r(10042),n=r(48190),i=r.n(n),s=r(63289),l={};for(let e in s)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>s[e]);r.d(t,l);let d=["",{children:["(cms)",{children:["dashboard",{children:["products",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,65332)),"/Users/jojo/Documents/Projects/money-tree-next/src/app/(cms)/dashboard/products/[id]/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,17004)),"/Users/jojo/Documents/Projects/money-tree-next/src/app/(cms)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,6042,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,6042,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/Users/jojo/Documents/Projects/money-tree-next/src/app/(cms)/dashboard/products/[id]/page.tsx"],c={require:r,loadChunk:()=>Promise.resolve()},f=new o.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(cms)/dashboard/products/[id]/page",pathname:"/dashboard/products/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},34515:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"602386b55223fcc338d2106e0bdfff44d7a3f3f3ee":()=>m,"60a5b869ca4645c8d08ae632fe74b8d531c5a58bbe":()=>f});var o=r(63722);r(20453);var a=r(32169),n=r(95553),i=r(93977),s=r(49411),l=r.n(s);async function d(e){let t=l().join(process.cwd(),"public",e);await (0,i.unlink)(t)}var u=r(20754),c=r(46309);async function f(e,t){let r=t.get("id");if(!r)return{error:"Something went wrong",ok:!1,data:{}};try{let e=await a.Z.query.$Products.findFirst({where:(0,u.eq)(n.$Products.id,Number(r))});if(e&&(e.previewImage&&await d(e.previewImage),e.images))for(let t of JSON.parse(e.images))t&&await d(t);let t=await a.Z.delete(n.$Products).where((0,u.eq)(n.$Products.id,Number(r)));return{error:null,data:t,ok:!1}}catch(e){if(e instanceof Error)return{error:e.message,data:{},ok:!1};return{error:"Something went wrong",data:{},ok:!1}}}(0,c.h)([f]),(0,o.j)(f,"60a5b869ca4645c8d08ae632fe74b8d531c5a58bbe",null);var p=r(28893);async function m(e,t){let r;let o=n.insertProductSchema.safeParse({id:Number(t.get("id")),title:t.get("title"),description:t.get("description"),sku:t.get("sku"),price:Number(t.get("price"))||void 0,discount:Number(t.get("discount"))||void 0,stock:Number(t.get("stock"))||void 0,categoryId:Number(t.get("categoryId"))||void 0,keywordsSearch:t.get("keywordsSearch"),isFeatured:"on"===t.get("isFeatured"),isActive:"on"===t.get("isActive")});if(!o.success)return{error:o.error.flatten().fieldErrors,ok:!1,data:{}};if(!o.data.id)return{error:"Something went wrong",ok:!1,data:{}};let i=[t.get("image1"),t.get("image2"),t.get("image3"),t.get("image4"),t.get("image5")],s=[];console.log("GALLERY_IMAGES",i);try{r=await a.Z.query.$Products.findFirst({where:(0,u.eq)(n.$Products.id,o.data.id)});let e=r?.images?JSON.parse(r.images):[null,null,null,null,null];if(!r)throw Error("Product not found");s=i.map(async(t,r)=>{if(!t||!(t instanceof Blob))throw Error("Файл не найден или неправильный формат");if(0===t.size)return e[r];let o=await (0,p.Z)(t,`${r}`);if(console.log("SAVE_FILE RES",o),e[r]&&await d(e[r]),!o.ok)throw Error(o.error||"Не удалось сохранить изображение");return"string"==typeof o.data?o.data:null})}catch(e){if(console.log(e),e instanceof Error)return{ok:!1,error:e.message,data:{}};return{ok:!1,error:"Unknown error",data:{}}}let l=t.get("preview");if(!l||!(l instanceof Blob))return{error:"Файл не найден или неправильный формат",ok:!1,data:{}};let c=null;if(l&&l.size>0){let e=await (0,p.Z)(l,"preview");if("string"==typeof e.data&&(c=e.data,r?.previewImage&&await d(r.previewImage)),e.error)return{error:e.error,ok:!1,data:{}}}try{c&&(o.data.previewImage=c);let e=JSON.stringify(await Promise.all(s)),t={...o.data,updatedAt:new Date().toISOString(),images:e},r=await a.Z.update(n.$Products).set(t).where((0,u.eq)(n.$Products.id,o.data.id));return console.log(r),{error:null,data:r,ok:!0}}catch(e){if(e instanceof Error)return{error:e.message,ok:!1,data:{}};return{error:"Something went wrong",ok:!1,data:{}}}}(0,c.h)([m]),(0,o.j)(m,"602386b55223fcc338d2106e0bdfff44d7a3f3f3ee",null)},56994:()=>{},13184:()=>{},12975:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,46472,23)),Promise.resolve().then(r.t.bind(r,42461,23)),Promise.resolve().then(r.t.bind(r,48190,23)),Promise.resolve().then(r.t.bind(r,15282,23)),Promise.resolve().then(r.t.bind(r,56613,23)),Promise.resolve().then(r.t.bind(r,5486,23)),Promise.resolve().then(r.t.bind(r,58825,23))},750:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,52144,23)),Promise.resolve().then(r.t.bind(r,62302,23)),Promise.resolve().then(r.t.bind(r,63582,23)),Promise.resolve().then(r.t.bind(r,9587,23)),Promise.resolve().then(r.t.bind(r,65329,23)),Promise.resolve().then(r.t.bind(r,50599,23)),Promise.resolve().then(r.t.bind(r,62118,23))},55877:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,60903,23)),Promise.resolve().then(r.t.bind(r,90821,23)),Promise.resolve().then(r.bind(r,22477)),Promise.resolve().then(r.bind(r,60592))},60306:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,62704,23)),Promise.resolve().then(r.t.bind(r,73510,23)),Promise.resolve().then(r.bind(r,21929)),Promise.resolve().then(r.bind(r,98594))},14971:(e,t,r)=>{"use strict";r.d(t,{default:()=>a.a});var o=r(39110),a=r.n(o)},39110:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return l},getImageProps:function(){return s}});let o=r(54564),a=r(97877),n=r(62704),i=o._(r(81911));function s(e){let{props:t}=(0,a.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let l=n.Image},42347:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var o=r(20149),a=r(14971),n=r(63606);function i({initialValue:e=null,keyName:t,label:r}){let[i,s]=(0,n.useState)(e);return(0,o.jsxs)("div",{className:"flex flex-col",children:[r&&(0,o.jsx)("label",{htmlFor:t,children:r}),(0,o.jsx)("input",{onChange:e=>{let t=e.target.files?.[0];t&&s(URL.createObjectURL(t))},type:"file",name:t,id:t,accept:"image/*"}),i&&(0,o.jsx)(a.default,{src:i,alt:t,width:200,height:200,className:"w-[200px] h-[200px] object-cover"})]})}},61307:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var o=r(20149);function a({showRequired:e=!0,label:t,hidden:r,...a}){let n="checkbox"===a.type,i=t&&t.length>0;return n?(0,o.jsxs)("div",{className:"flex",children:[(0,o.jsx)("input",{...a}),(0,o.jsx)("label",{htmlFor:a.id,className:"ml-2 text-sm",children:t})]}):(0,o.jsx)("div",{className:"flex flex-col"+(r?" hidden":""),children:i?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("label",{htmlFor:a.id,className:"ml-2 mb-3",children:t}),(0,o.jsxs)("div",{className:"relative flex max-w-[400px]",children:[(0,o.jsx)("input",{...a,className:"bg-white-100 flex-1 rounded-2xl py-4 px-6 text-base border-none mb-3 "+a.className}),a.required&&e&&(0,o.jsx)("span",{className:"text-red-500 absolute right-4 top-[calc(50%-16px)]",children:"*"})]})]}):(0,o.jsxs)("div",{className:"relative flex max-w-[400px]",children:[(0,o.jsx)("input",{...a,className:"bg-white-100 flex-1 rounded-2xl py-4 px-6 text-base border-none mb-3 "+a.className}),a.required&&e&&(0,o.jsx)("span",{className:"text-red-500 absolute right-4 "+(i?"top-[calc(50%+2px)]":"top-[calc(50%-16px)]"),children:"*"})]})})}},81775:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var o=r(20149);function a({label:e,...t}){return e&&e.length>0?(0,o.jsxs)("div",{className:"flex flex-col relative",children:[(0,o.jsx)("label",{htmlFor:t.id,className:"ml-2 mb-3",children:e}),(0,o.jsx)("textarea",{id:t.id,className:"bg-white-100 rounded-2xl py-4 px-6 text-base border-none mb-3 resize-y",...t})]}):(0,o.jsx)("textarea",{className:"bg-white-100 flex w-full max-w-[400px] rounded-2xl py-4 px-6 text-base border-none mb-3 resize-y",...t})}r(63606)},21929:(e,t,r)=>{"use strict";r.d(t,{default:()=>l});var o=r(20149),a=r(63606),n=r(61307),i=r(8412);let s=(0,i.createServerReference)("60a5b869ca4645c8d08ae632fe74b8d531c5a58bbe",i.callServer,void 0,i.findSourceMapURL,"deleteProductActon");function l({product:e}){let[t,r,i]=(0,a.useActionState)(s,{data:{},ok:!1,error:null});return void 0===e?(0,o.jsx)("div",{children:"Product not found"}):(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("form",{className:"flex flex-col max-w-[400px] flex-1 mb-4",action:r,children:[(0,o.jsx)(n.Z,{hidden:!0,label:"id",defaultValue:e.id,type:"number",name:"id",id:"id",placeholder:"id",required:!0}),t.error&&(0,o.jsx)("pre",{children:JSON.stringify(t)}),(0,o.jsx)("button",{disabled:i,className:"bg-red-400 rounded-2xl py-4 px-6 text-base border-none mt-8 text-white-100 hover:bg-red-500 disabled:bg-gray-400",type:"submit",children:"Удалить"})]})})}},98594:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var o=r(20149),a=r(63606),n=r(61307),i=r(81775),s=r(42347),l=r(8412);let d=(0,l.createServerReference)("602386b55223fcc338d2106e0bdfff44d7a3f3f3ee",l.callServer,void 0,l.findSourceMapURL,"default");function u({product:e}){let[t,r,l]=(0,a.useActionState)(d,{error:null,data:{}}),u=JSON.parse(e.images||"[]");if(u.length<5)for(let e=u.length;e<5;e++)u.push(null);return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("form",{className:"flex flex-col mb-4",action:r,children:[(0,o.jsxs)("div",{className:"flex w-full justify-between",children:[(0,o.jsxs)("div",{className:"flex-1 max-w-[400px] mr-4",children:[(0,o.jsx)(n.Z,{label:"Название",defaultValue:e.title,type:"text",name:"title",id:"title",placeholder:"Название",required:!0}),(0,o.jsx)(i.Z,{label:"Описание",defaultValue:e.description||"",name:"description",id:"description",placeholder:"Описание"}),(0,o.jsx)(n.Z,{label:"Артикул",defaultValue:e.sku,type:"text",name:"sku",id:"sku",placeholder:"Артикул",required:!0}),(0,o.jsx)(n.Z,{label:"Цена",defaultValue:e.price,type:"number",name:"price",id:"price",placeholder:"Цена",required:!0})]}),(0,o.jsxs)("div",{className:"flex-1 mr-4",children:[(0,o.jsx)(n.Z,{label:"Скидка",defaultValue:e.discount||0,type:"number",name:"discount",id:"discount",placeholder:"Скидка"}),(0,o.jsx)(n.Z,{label:"Наличие",defaultValue:e.stock,type:"number",name:"stock",id:"stock",placeholder:"Наличие",required:!0}),(0,o.jsx)(n.Z,{label:"Категория",defaultValue:e.categoryId||"",type:"text",name:"categoryId",id:"categoryId",placeholder:"Категория [id]"}),(0,o.jsx)(n.Z,{label:"Ключевые слова",defaultValue:e.keywordsSearch||"",type:"text",name:"keywordsSearch",id:"keywordsSearch",placeholder:"Ключевые слова"})]})]}),(0,o.jsx)(n.Z,{hidden:!0,label:"id",defaultValue:e.id,type:"number",name:"id",id:"id",placeholder:"id",required:!0}),(0,o.jsx)(n.Z,{defaultChecked:e.isFeatured||void 0,label:"Добавить на главный экран",type:"checkbox",name:"isFeatured",id:"isFeatured"}),(0,o.jsx)(n.Z,{defaultChecked:e.isActive||void 0,label:"Активировать",type:"checkbox",name:"isActive",id:"isActive"}),(0,o.jsx)(s.Z,{label:"Превью",keyName:"preview",initialValue:e.previewImage}),(0,o.jsx)("h2",{className:"text-2xl mb-1",children:"Галерея"}),(0,o.jsx)("div",{className:"flex flex-wrap",children:u.map((e,t)=>(0,o.jsx)(s.Z,{label:`Изображение ${t+1}`,keyName:`image${t+1}`,initialValue:e},e+`${t+1}`))}),t.error&&(0,o.jsx)("pre",{children:JSON.stringify(t)}),(0,o.jsx)("button",{disabled:l,className:"bg-orange-400 rounded-2xl py-4 px-6 text-base border-none mt-8 text-white-100 hover:bg-orange-500 disabled:bg-gray-400",type:"submit",children:"Обновить"})]})})}},71623:(e,t,r)=>{"use strict";var o=r(85941);r.o(o,"redirect")&&r.d(t,{redirect:function(){return o.redirect}})},46898:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isNextRouterError",{enumerable:!0,get:function(){return n}});let o=r(77361),a=r(14722);function n(e){return(0,a.isRedirectError)(e)||(0,o.isNotFoundError)(e)}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},85941:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{ReadonlyURLSearchParams:function(){return s},RedirectType:function(){return o.RedirectType},notFound:function(){return a.notFound},permanentRedirect:function(){return o.permanentRedirect},redirect:function(){return o.redirect},unstable_rethrow:function(){return n.unstable_rethrow}});let o=r(14722),a=r(77361),n=r(29097);class i extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class s extends URLSearchParams{append(){throw new i}delete(){throw new i}set(){throw new i}sort(){throw new i}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},14852:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RedirectStatusCode",{enumerable:!0,get:function(){return r}}),function(e){e[e.SeeOther=303]="SeeOther",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect"}(r||(r={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},14722:(e,t,r)=>{"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{RedirectType:function(){return o},getRedirectError:function(){return s},getRedirectStatusCodeFromError:function(){return p},getRedirectTypeFromError:function(){return f},getURLFromRedirectError:function(){return c},isRedirectError:function(){return u},permanentRedirect:function(){return d},redirect:function(){return l}});let a=r(209),n=r(14852),i="NEXT_REDIRECT";function s(e,t,r){void 0===r&&(r=n.RedirectStatusCode.TemporaryRedirect);let o=Error(i);return o.digest=i+";"+t+";"+e+";"+r+";",o}function l(e,t){let r=a.actionAsyncStorage.getStore();throw s(e,t||((null==r?void 0:r.isAction)?"push":"replace"),n.RedirectStatusCode.TemporaryRedirect)}function d(e,t){throw void 0===t&&(t="replace"),s(e,t,n.RedirectStatusCode.PermanentRedirect)}function u(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let t=e.digest.split(";"),[r,o]=t,a=t.slice(2,-2).join(";"),s=Number(t.at(-2));return r===i&&("replace"===o||"push"===o)&&"string"==typeof a&&!isNaN(s)&&s in n.RedirectStatusCode}function c(e){return u(e)?e.digest.split(";").slice(2,-2).join(";"):null}function f(e){if(!u(e))throw Error("Not a redirect error");return e.digest.split(";",2)[1]}function p(e){if(!u(e))throw Error("Not a redirect error");return Number(e.digest.split(";").at(-2))}(function(e){e.push="push",e.replace="replace"})(o||(o={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},29097:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"unstable_rethrow",{enumerable:!0,get:function(){return function e(t){if((0,i.isNextRouterError)(t)||(0,n.isBailoutToCSRError)(t)||(0,o.isDynamicUsageError)(t)||(0,a.isPostpone)(t))throw t;t instanceof Error&&"cause"in t&&e(t.cause)}}});let o=r(66714),a=r(15730),n=r(38465),i=r(46898);("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},66714:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isDynamicUsageError",{enumerable:!0,get:function(){return s}});let o=r(3105),a=r(38465),n=r(46898),i=r(94375),s=e=>(0,o.isDynamicServerError)(e)||(0,a.isBailoutToCSRError)(e)||(0,n.isNextRouterError)(e)||(0,i.isDynamicPostpone)(e)},15730:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isPostpone",{enumerable:!0,get:function(){return o}});let r=Symbol.for("react.postpone");function o(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}},38465:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{BailoutToCSRError:function(){return o},isBailoutToCSRError:function(){return a}});let r="BAILOUT_TO_CLIENT_SIDE_RENDERING";class o extends Error{constructor(e){super("Bail out to client-side rendering: "+e),this.reason=e,this.digest=r}}function a(e){return"object"==typeof e&&null!==e&&"digest"in e&&e.digest===r}},65332:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f,metadata:()=>c});var o=r(47705),a=r(22477),n=r(60592),i=r(38176),s=r(93726),l=r(84160),d=r(99069),u=r(71623);let c={title:"Product Dashboard",description:""};async function f({params:e}){let t;let{id:r}=await e;try{t=await s.Z.query.$Products.findFirst({where:(0,d.eq)(l.$Products.id,r)})}catch(e){console.log(e)}return t||(0,u.redirect)("/dashboard"),(0,o.jsx)("div",{className:"container",children:(0,o.jsxs)("div",{children:[(0,o.jsx)(i.Z,{className:"my-6",cost:t.price,discount:t.discount,id:t.id?.toString()||"",image:t.previewImage,title:t.title}),(0,o.jsx)(n.default,{product:t}),(0,o.jsx)(a.default,{product:t})]})})}},17004:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i,metadata:()=>a,viewport:()=>n});var o=r(47705);r(47453),r(32528);let a={title:"dashboard",description:""},n={width:"device-width",initialScale:1};function i({children:e}){return(0,o.jsx)("html",{lang:"ru",children:(0,o.jsx)("body",{children:e})})}},22477:(e,t,r)=>{"use strict";r.d(t,{default:()=>o});let o=(0,r(78105).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/jojo/Documents/Projects/money-tree-next/src/components/app/ui/layout/dashboard/products/forms/DeleteForm.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jojo/Documents/Projects/money-tree-next/src/components/app/ui/layout/dashboard/products/forms/DeleteForm.tsx","default")},60592:(e,t,r)=>{"use strict";r.d(t,{default:()=>o});let o=(0,r(78105).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/jojo/Documents/Projects/money-tree-next/src/components/app/ui/layout/dashboard/products/forms/UpdateProductForm.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jojo/Documents/Projects/money-tree-next/src/components/app/ui/layout/dashboard/products/forms/UpdateProductForm.tsx","default")},38176:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var o=r(47705);let a=function(){for(var e,t,r=0,o="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=function e(t){var r,o,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t){if(Array.isArray(t)){var n=t.length;for(r=0;r<n;r++)t[r]&&(o=e(t[r]))&&(a&&(a+=" "),a+=o)}else for(o in t)t[o]&&(a&&(a+=" "),a+=o)}return a}(e))&&(o&&(o+=" "),o+=t);return o};var n=r(76217),i=r(23496);r(66833);let s=function({cost:e=0,discount:t,id:r,image:s,title:l,className:d}){return(0,o.jsxs)(i.default,{className:a("relative flex flex-col overflow-hidden max-w-[266px] rounded-3xl shadow-[0px_0px_16px_0_rgba(51,37,87,0.15)]",d),href:`/product/${r}`,children:[t?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"absolute top-4 right-4 bg-red-500 text-white-100  text-sm font-medium p-[6px] rounded-full",children:"Распродажа"}),(0,o.jsxs)("span",{className:"absolute top-4 left-4  bg-red-500 text-white-100 text-sm font-medium p-[6px] rounded-full",children:[Math.floor(100-(e-t)/e*100),"%"]})]}):null,(0,o.jsx)(n.default,{alt:l,width:266,height:235,src:s||"https://placehold.co/266x235/000000/FFFFFF/png"}),(0,o.jsxs)("div",{className:"p-4",children:[(0,o.jsx)("h3",{className:"text-base text-foreground mb-4",children:l}),t?(0,o.jsxs)("p",{className:"text-green-400 flex items-center text-xl w-fit rounded-xl py-3 px-6 bg-gray-100 ",children:[e-t,"₽ ",(0,o.jsxs)("span",{className:"line-through ml-1 text-gray-400 text-xs",children:[e,"₽"]})]}):(0,o.jsxs)("p",{className:"text-foreground flex text-xl w-fit rounded-xl py-3 px-6 bg-gray-100",children:[e,"₽"]})]})]},r)}},32169:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var o=r(46223),a=r(85890),n=r.n(a),i=r(95553);let s=new(n())(process.env.DB_FILE_NAME),l=(0,o.t)({client:s,schema:i})},93726:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var o=r(54797),a=r(85890),n=r.n(a),i=r(84160);let s=new(n())(process.env.DB_FILE_NAME),l=(0,o.t)({client:s,schema:i})},95553:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$Categories:()=>l,$Products:()=>c,$Users:()=>s,insertCategorySchema:()=>d,insertProductSchema:()=>f,selectCategorySchema:()=>u,selectProductSchema:()=>p});var o=r(43642),a=r(78657),n=r(81867),i=r(43951);let s=(0,o.Px)("users",{id:(0,a.e$)().primaryKey({autoIncrement:!0}),email:(0,n.fL)().notNull().unique(),password_hash:(0,n.fL)().notNull(),salt:(0,n.fL)().notNull()}),l=(0,o.Px)("categories",{id:(0,a.e$)().primaryKey({autoIncrement:!0}),name:(0,n.fL)("name").notNull(),parentId:(0,a._L)("parent_id").references(()=>l.id,{onDelete:"cascade"})}),d=(0,i.fC)(l),u=(0,i.IO)(l),c=(0,o.Px)("products",{id:(0,a._L)("id").primaryKey({autoIncrement:!0}),sku:(0,n.fL)("sku").notNull().unique(),title:(0,n.fL)("title").notNull(),description:(0,n.fL)("description"),price:(0,a._L)("price").notNull().default(0),discount:(0,a._L)("discount").default(0),stock:(0,a._L)("stock").notNull().default(0),previewImage:(0,n.fL)("previewImage"),images:(0,n.fL)("images").notNull().$default(()=>JSON.stringify([null,null,null,null,null])),categoryId:(0,a._L)("category_id").references(()=>l.id,{onDelete:"set null"}),keywordsSearch:(0,n.fL)("keywordsSearch"),isFeatured:(0,a._L)("isFeatured",{mode:"boolean"}).default(!1),isActive:(0,a._L)("isActive",{mode:"boolean"}).default(!0),createdAt:(0,n.fL)("createdAt").default(new Date().toISOString()).notNull(),updatedAt:(0,n.fL)("updatedAt").default(new Date().toISOString()).notNull()}),f=(0,i.fC)(c),p=(0,i.IO)(c)},84160:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$Categories:()=>l,$Products:()=>c,$Users:()=>s,insertCategorySchema:()=>d,insertProductSchema:()=>f,selectCategorySchema:()=>u,selectProductSchema:()=>p});var o=r(89155),a=r(76718),n=r(20971),i=r(40745);let s=(0,o.Px)("users",{id:(0,a.e$)().primaryKey({autoIncrement:!0}),email:(0,n.fL)().notNull().unique(),password_hash:(0,n.fL)().notNull(),salt:(0,n.fL)().notNull()}),l=(0,o.Px)("categories",{id:(0,a.e$)().primaryKey({autoIncrement:!0}),name:(0,n.fL)("name").notNull(),parentId:(0,a._L)("parent_id").references(()=>l.id,{onDelete:"cascade"})}),d=(0,i.fC)(l),u=(0,i.IO)(l),c=(0,o.Px)("products",{id:(0,a._L)("id").primaryKey({autoIncrement:!0}),sku:(0,n.fL)("sku").notNull().unique(),title:(0,n.fL)("title").notNull(),description:(0,n.fL)("description"),price:(0,a._L)("price").notNull().default(0),discount:(0,a._L)("discount").default(0),stock:(0,a._L)("stock").notNull().default(0),previewImage:(0,n.fL)("previewImage"),images:(0,n.fL)("images").notNull().$default(()=>JSON.stringify([null,null,null,null,null])),categoryId:(0,a._L)("category_id").references(()=>l.id,{onDelete:"set null"}),keywordsSearch:(0,n.fL)("keywordsSearch"),isFeatured:(0,a._L)("isFeatured",{mode:"boolean"}).default(!1),isActive:(0,a._L)("isActive",{mode:"boolean"}).default(!0),createdAt:(0,n.fL)("createdAt").default(new Date().toISOString()).notNull(),updatedAt:(0,n.fL)("updatedAt").default(new Date().toISOString()).notNull()}),f=(0,i.fC)(c),p=(0,i.IO)(c)},28893:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var o=r(6005),a=r(93977),n=r(49411),i=r.n(n);async function s(e,t=""){let r=await e.arrayBuffer(),n=Buffer.from(r),l=e.type.split("/")[1]||"dat",d=`${t?t+"_":""}${(0,o.randomUUID)()}.${l}`,u=i().join(process.cwd(),"public","uploads"),c=i().join(u,d);try{await (0,a.mkdir)(u,{recursive:!0})}catch(e){return console.error("Ошибка при создании директории:",e),{ok:!1,error:"Не удалось создать директорию",data:{}}}return await (0,a.writeFile)(c,n).then(()=>({ok:!0,error:null,data:`/uploads/${d}`})).catch(e=>(console.error("Ошибка при записи файла:",e),e instanceof Error)?{ok:!1,error:e.message,data:{}}:{ok:!1,error:"Unknown error",data:{}})}},73881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var o=r(15394);let a=async e=>[{type:"image/x-icon",sizes:"32x31",url:(0,o.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},32528:()=>{}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[492,146,394,704,710,805,816],()=>r(5197));module.exports=o})();